<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Greetings</title>
  <!-- SEO Meta Tags -->
  <meta name="description" content="Greetings - Personalized encouragement for every moment. Uplift your day with dynamic, accessible, and beautiful greetings." />
  <meta name="keywords" content="greetings, encouragement, HTML, CSS, JavaScript, wellness, motivation" />
  <meta name="author" content="asilva777" />
  <!-- PWA and Theme -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#4a90e2">
  <link rel="icon" href="icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="icon-192.png">
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <!-- External CSS -->
  <link rel="stylesheet" href="style.css">
  <!-- Internal CSS for Dynamic/Override Styles -->
  <style>
    :root {
      --primary-color: #4a90e2;
      --secondary-color: #f1f6fb;
      --accent-color: #ffd54f;
      --morning-bg: linear-gradient(135deg, #FFFBCC 0%, #fffbe6 100%);
      --afternoon-bg: linear-gradient(135deg, #CFF0FF 0%, #e0f7fa 100%);
      --evening-bg: linear-gradient(135deg, #FFDAB9 0%, #ffe4b2 100%);
      --night-bg: linear-gradient(135deg, #232946 0%, #2e3a59 100%);
      --weekend-bg: linear-gradient(135deg, #fbc2eb 0%, #a6c1ee 100%);
      --holiday-bg: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      --error-color: #d32f2f;
      --success-color: #388e3c;
    }
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Montserrat', Arial, Helvetica, sans-serif;
      min-height: 100vh;
      min-width: 100vw;
      height: 100%;
      width: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--secondary-color);
      transition: background 1s;
      color-scheme: light dark;
    }
    .container {
      max-width: 600px;
      width: 94vw;
      padding: 2rem 1rem;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.13);
      margin: 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      animation: fadeIn 1s;
      outline: none;
    }
    h1 {
      font-size: 2.3rem;
      color: var(--primary-color);
      margin-bottom: 0.7rem;
      transition: color 0.5s;
    }
    p {
      font-size: 1.25rem;
      line-height: 1.65;
      margin-bottom: 1.8rem;
      color: #333;
    }
    .fade-in {
      opacity: 0;
      animation: fadeIn 1s forwards;
    }
    @keyframes fadeIn {
      to { opacity: 1; }
    }
    .tagline {
      margin-top: 1.7rem;
      font-size: 1.05rem;
      color: #666;
    }
    .username-form {
      margin-bottom: 1.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    .username-form label {
      margin-bottom: 0.3em;
      font-weight: 600;
    }
    .username-form input {
      font-size: 1rem;
      padding: 0.5em 1em;
      border: 1px solid #b0bec5;
      border-radius: 8px;
      margin-bottom: 0.8em;
      outline: none;
      width: 90%;
      max-width: 300px;
    }
    .username-form input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 2px var(--primary-color);
    }
    .username-form button {
      background: var(--primary-color);
      color: #fff;
      border: none;
      padding: 0.5em 1.3em;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.3s;
    }
    .username-form button:hover,
    .username-form button:focus {
      background: #357ab7;
      outline: none;
    }
    .btn-another {
      background: var(--accent-color);
      color: #333;
      border: none;
      border-radius: 8px;
      padding: 0.5em 1.5em;
      font-size: 1.05rem;
      font-weight: 600;
      margin-top: 0.8em;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      transition: background 0.2s, color 0.2s;
    }
    .btn-another:hover, .btn-another:focus {
      background: #ffe082;
      color: #1a1a1a;
      outline: none;
    }
    .message-status {
      margin-top: 0.5em;
      font-size: 1rem;
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .message-status.visible {
      opacity: 1;
    }
    .message-status.error { color: var(--error-color); }
    .message-status.success { color: var(--success-color); }
    @media (max-width: 700px) {
      .container { max-width: 98vw; }
      h1 { font-size: 1.5rem;}
      p { font-size: 1.05rem;}
    }
    @media (max-width: 400px) {
      .container { padding: 1rem 0.2rem; }
      h1 { font-size: 1.15rem;}
      p { font-size: 0.9rem;}
    }
  </style>
</head>
<body>
  <main class="container" tabindex="-1" aria-labelledby="greeting">
    <form class="username-form" id="usernameForm" aria-label="Name input form" autocomplete="off" style="display:none;">
      <label for="usernameInput">What's your name?</label>
      <input type="text" id="usernameInput" name="username" placeholder="Enter your name" required aria-required="true" aria-label="Enter your name" maxlength="32" pattern="^[a-zA-Z0-9\s.'\-]{1,32}$" />
      <button type="submit" aria-label="Save name">Save</button>
      <div class="message-status" id="formStatus" role="alert" aria-live="polite"></div>
    </form>
    <h1 id="greeting" class="fade-in" tabindex="0">Welcome</h1>
    <p id="message" class="fade-in" tabindex="0">You are valued and your well-being matters. 💙</p>
    <button class="btn-another" id="anotherMessage" aria-label="Show another greeting" tabindex="0">Another Message</button>
  </main>
  <script>
    // --- Accessibility: Move focus as needed ---
    function moveFocusToId(id) {
      const el = document.getElementById(id);
      if (el) el.focus();
    }

    // --- Greetings and Compliments ---
    const greetings = {
      morning: {
        title: ["Good Morning 🌞", "Rise and Shine! 🌅", "Morning, Sunshine!"],
        message: [
          "Start your day with purpose and kindness.",
          "You are resilient and capable.",
          "May today bring you joy and clarity.",
          "Your energy inspires the world around you."
        ]
      },
      afternoon: {
        title: ["Good Afternoon 🌤️", "Hello, Beautiful Afternoon!", "Keep Going!"],
        message: [
          "Pause and breathe. Your presence is enough.",
          "Keep moving forward with grace.",
          "Every effort counts — you’re doing great.",
          "Let your spirit stay bright as the sun."
        ]
      },
      evening: {
        title: ["Good Evening 🌇", "Evening Reflections 🌠", "Unwind and Recharge"],
        message: [
          "Reflect on your day with compassion.",
          "Rest is a powerful form of resilience.",
          "You’ve earned this moment of peace.",
          "Let gratitude fill your evening."
        ]
      },
      night: {
        title: ["Hello Night Owl 🌙", "Peaceful Night ✨", "Rest Well"],
        message: [
          "Take a moment for self-care. You’ve made it through today.",
          "You are not alone.",
          "Let tomorrow wait — tonight is for you.",
          "Dream big, sleep deeply, and know you are enough."
        ]
      }
    };

    const compliments = [
      "You are awesome! 🚀",
      "Keep shining!",
      "Your smile is contagious 😊",
      "Believe in yourself!",
      "You make a difference every day.",
      "Your kindness lights up the world.",
      "You bring out the best in others.",
      "You radiate positivity!",
      "Your courage inspires me.",
      "You are a force for good."
    ];

    // Add more holidays as desired
    const holidays = {
      "01-01": "Happy New Year! 🎉 Wishing you a year of joy and growth.",
      "12-25": "Merry Christmas! 🎄 May your heart be light and your days bright.",
      "07-04": "Happy Independence Day! 🇺🇸 Celebrate freedom and unity."
      // Extend as needed
    };

    // --- Utilities ---
    function getTimeOfDay(hour) {
      if (hour >= 5 && hour < 12) return 'morning';
      if (hour >= 12 && hour < 17) return 'afternoon';
      if (hour >= 17 && hour < 21) return 'evening';
      return 'night';
    }
    function isWeekend(date) {
      return date.getDay() === 0 || date.getDay() === 6;
    }
    function getHolidayMessage(date) {
      const md = String(date.getMonth() + 1).padStart(2, '0') + '-' + String(date.getDate()).padStart(2, '0');
      return holidays[md] || null;
    }
    function randomFrom(arr) {
      return arr[Math.floor(Math.random() * arr.length)];
    }
    function sanitizeName(name) {
      // Only allow letters, numbers, spaces, and a few common punctuation (apostrophe, period, hyphen)
      return name.replace(/[^a-zA-Z0-9\s.'\-]/g, '').trim().slice(0, 32);
    }

    // --- LocalStorage for Username ---
    function getUserName() {
      return localStorage.getItem("greetUserName") || "";
    }
    function setUserName(name) {
      localStorage.setItem("greetUserName", name);
    }
    function clearUserName() {
      localStorage.removeItem("greetUserName");
    }

    // --- UI Handlers ---
    function askForName() {
      document.getElementById("usernameForm").style.display = "flex";
      moveFocusToId("usernameInput");
    }
    function hideNameForm() {
      document.getElementById("usernameForm").style.display = "none";
    }

    // --- Dynamic Background ---
    function setDynamicBackground(timeOfDay, date) {
      const body = document.body;
      const holidayMsg = getHolidayMessage(date);
      if (holidayMsg) {
        body.style.background = "var(--holiday-bg)";
      } else if (isWeekend(date)) {
        body.style.background = "var(--weekend-bg)";
      } else if (timeOfDay === "morning") {
        body.style.background = "var(--morning-bg)";
      } else if (timeOfDay === "afternoon") {
        body.style.background = "var(--afternoon-bg)";
      } else if (timeOfDay === "evening") {
        body.style.background = "var(--evening-bg)";
      } else {
        body.style.background = "var(--night-bg)";
      }
    }

    // --- Main Greeting Update ---
    function updateGreeting(randomize = true) {
      const now = new Date();
      const hour = now.getHours();
      const timeOfDay = getTimeOfDay(hour);

      setDynamicBackground(timeOfDay, now);

      const greetingEl = document.getElementById("greeting");
      const messageEl = document.getElementById("message");
      let userName = getUserName();
      let holidayMsg = getHolidayMessage(now);

      // Animate out
      greetingEl.classList.remove('fade-in');
      messageEl.classList.remove('fade-in');

      setTimeout(() => {
        // Prefer holiday
        if (holidayMsg) {
          greetingEl.innerText = (userName ? `Hi ${userName}, ` : "") + "Special Greetings!";
          messageEl.innerText = holidayMsg + " " + randomFrom(compliments);
        }
        // Weekend
        else if (isWeekend(now)) {
          greetingEl.innerText = (userName ? `Happy Weekend, ${userName}! 🎉` : "Happy Weekend! 🎉");
          messageEl.innerText = "Take time for yourself. You deserve joy and relaxation. " + randomFrom(compliments);
        }
        // Weekday/Time-based
        else {
          const gTitle = randomize ? randomFrom(greetings[timeOfDay].title) : greetings[timeOfDay].title[0];
          const gMsg = randomize ? randomFrom(greetings[timeOfDay].message) : greetings[timeOfDay].message[0];
          greetingEl.innerText = (userName ? `${gTitle}, ${userName}!` : gTitle);
          messageEl.innerText = gMsg + " " + randomFrom(compliments);
        }
        // Animate in
        greetingEl.classList.add('fade-in');
        messageEl.classList.add('fade-in');
        greetingEl.setAttribute('tabindex', '0');
        messageEl.setAttribute('tabindex', '0');
      }, 100); // Short delay for reflow
    }

    // --- Form Logic & Validation ---
    document.getElementById("usernameForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const input = document.getElementById("usernameInput");
      const statusEl = document.getElementById("formStatus");
      let name = sanitizeName(input.value);

      if (!name) {
        statusEl.textContent = "Please enter a valid name (letters, numbers, spaces, and .'-).";
        statusEl.className = "message-status visible error";
        moveFocusToId("usernameInput");
        return;
      }

      setUserName(name);
      statusEl.textContent = "Name saved!";
      statusEl.className = "message-status visible success";
      setTimeout(() => {
        statusEl.textContent = "";
        statusEl.className = "message-status";
        hideNameForm();
        updateGreeting();
        moveFocusToId("greeting");
      }, 700);
    });

    // --- Show name prompt if needed ---
    window.addEventListener("DOMContentLoaded", () => {
      if (!getUserName()) {
        askForName();
      } else {
        updateGreeting();
        moveFocusToId("greeting");
      }
    });

    // --- Interactive: another message button ---
    document.getElementById("anotherMessage").addEventListener("click", () => {
      updateGreeting(true);
      moveFocusToId("greeting");
    });

    // --- Accessibility: keyboard activation for button ---
    document.getElementById("anotherMessage").addEventListener("keyup", function(e) {
      if (e.key === "Enter" || e.key === " ") {
        updateGreeting(true);
        moveFocusToId("greeting");
      }
    });

    // --- Clear username on Escape for demo/UX (optional) ---
    document.addEventListener("keydown", function(e) {
      if (e.key === "Escape" && getUserName()) {
        clearUserName();
        askForName();
        updateGreeting();
        moveFocusToId("usernameInput");
      }
    });

    // --- Service Worker registration for PWA ---
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('service-worker.js')
          .catch(function(error) {
            console.error('Service Worker registration failed:', error);
          });
      });
    }
  </script>
  <!-- Defer external script if needed -->
  <!-- <script src="script.js" defer></script> -->
</body>
</html>
